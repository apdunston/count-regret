{"version":3,"sources":["js/app.js","js/networkDriver.js","js/socket.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzCA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA/FA;AAAA","file":"../priv/static/js/app.js","sourcesContent":["\"use strict\";\n\nrequire(\"phoenix_html\");\n\nvar _socket = require(\"./socket\");\n\nvar _socket2 = _interopRequireDefault(_socket);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar NetworkDriver = exports.NetworkDriver = {\n    origin: \"Count Regret Server\",\n\n    setGame: function setGame(game) {\n        this.game = game;\n    },\n\n    setChannel: function setChannel(channel) {\n        this.channel = channel;\n    },\n\n    sendMaze: function sendMaze() {\n        this.channel.push(\"set_maze\", this.game.maze);\n    },\n\n    receiveMaze: function receiveMaze(maze) {\n        this.game.setMaze(maze);\n    },\n\n    sendWin: function sendWin(playerNumber) {\n        this.channel.push(\"win\", playerNumber);\n    },\n\n    send: function send(event) {\n        console.log(\"networkDriver.send\");\n        this.channel.push(\"move\", { player_number: event.playerNumber, x: event.x, y: event.y });\n    },\n\n    receive: function receive(event) {\n        console.log(\"NetworkDriver Received: \", event);\n        console.log(\"Positions: \", event.players);\n        if (this.game) {\n            this.game.setPositions(event.players);\n        }\n    }\n};\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _phoenix = require(\"phoenix\");\n\nvar _networkDriver = require(\"./networkDriver.js\");\n\nvar _jquery = require(\"jquery\");\n\nvar _jquery2 = _interopRequireDefault(_jquery);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar socket = new _phoenix.Socket(\"/socket\", { params: { token: window.userToken } });\nsocket.connect();\n\nvar lobby_channel = socket.channel(\"game:lobby\", {});\nvar game_channel = null;\nvar hollow_cart = new HollowCart();\nvar player_number = 24601;\n\nvar join_game = function join_game() {\n  var game_name = (0, _jquery2.default)('input[name=game-name]').val();\n  console.log(\"Trying to join game: \" + game_name);\n  join_game_channel(game_name, function (resp) {\n    console.log(\"Joined game successfully\", resp);\n    display_game(resp);\n    hollow_cart.startTrustContent(resp.maze, _networkDriver.NetworkDriver, resp.player_number);\n    _networkDriver.NetworkDriver.receive(resp);\n  });\n};\n\nvar display_game = function display_game(payload) {\n  (0, _jquery2.default)('.controls').html(\"<p>Game Name: \" + payload.game_name + \"</p>\");\n};\n\nvar join_game_channel = function join_game_channel(game_name, ok_function) {\n  game_channel = socket.channel(\"game:\" + game_name, {});\n  game_channel.on(\"key_down\", function (payload) {\n    console.log(\"Received key_down broadcast: \", payload);\n  });\n  game_channel.on(\"positions\", function (payload) {\n    _networkDriver.NetworkDriver.receive(payload);\n  });\n  game_channel.on(\"set_maze\", function (payload) {\n    _networkDriver.NetworkDriver.receiveMaze(payload);\n  });\n  game_channel.join().receive(\"ok\", ok_function).receive(\"error\", function (resp) {\n    console.log(\"Unable to join game\", resp);\n  });\n\n  _networkDriver.NetworkDriver.setChannel(game_channel);\n};\n\nvar start_game = function start_game() {\n  console.log(\"Starting game...\");\n  lobby_channel.push(\"new_game\").receive(\"ok\", function (resp) {\n    console.log(\"new_game response\", resp);\n    display_game(resp);\n    join_game_channel(resp.game_name, function (arg) {\n      console.log(\"Started game successfully\", arg);\n      var maze = hollow_cart.startTrustContent(maze, _networkDriver.NetworkDriver, 0);\n      _networkDriver.NetworkDriver.setGame(hollow_cart.getCurrentGame());\n      _networkDriver.NetworkDriver.sendMaze(maze);\n      _networkDriver.NetworkDriver.receive(arg);\n    });\n  });\n};\n\n(0, _jquery2.default)(function () {\n  (0, _jquery2.default)('.start-button').click(function () {\n    start_game();\n  });\n\n  (0, _jquery2.default)('input[name=game-name]').keydown(function (event) {\n    if (event.keyCode == 13) {\n      start_game();\n    }\n  });\n\n  (0, _jquery2.default)('.join-button').click(function () {\n    join_game();\n  });\n});\n\nlobby_channel.join().receive(\"ok\", function (resp) {\n  console.log(\"Joined lobby successfully\", resp);\n}).receive(\"error\", function (resp) {\n  console.log(\"Unable to join lobby\", resp);\n});\n\nexports.default = socket;\n"]}